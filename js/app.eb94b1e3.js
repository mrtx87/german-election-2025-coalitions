(function(){var t={5358:function(t,e,s){var r={"./af":2190,"./af.js":2190,"./ar":7218,"./ar-dz":5785,"./ar-dz.js":5785,"./ar-kw":9417,"./ar-kw.js":9417,"./ar-ly":6904,"./ar-ly.js":6904,"./ar-ma":8617,"./ar-ma.js":8617,"./ar-ps":1318,"./ar-ps.js":1318,"./ar-sa":2699,"./ar-sa.js":2699,"./ar-tn":6789,"./ar-tn.js":6789,"./ar.js":7218,"./az":3050,"./az.js":3050,"./be":8316,"./be.js":8316,"./bg":310,"./bg.js":310,"./bm":8884,"./bm.js":8884,"./bn":3469,"./bn-bd":6672,"./bn-bd.js":6672,"./bn.js":3469,"./bo":9118,"./bo.js":9118,"./br":3113,"./br.js":3113,"./bs":3626,"./bs.js":3626,"./ca":921,"./ca.js":921,"./cs":7799,"./cs.js":7799,"./cv":2828,"./cv.js":2828,"./cy":3521,"./cy.js":3521,"./da":6962,"./da.js":6962,"./de":3294,"./de-at":6158,"./de-at.js":6158,"./de-ch":5960,"./de-ch.js":5960,"./de.js":3294,"./dv":7963,"./dv.js":7963,"./el":3432,"./el.js":3432,"./en-au":998,"./en-au.js":998,"./en-ca":5931,"./en-ca.js":5931,"./en-gb":5930,"./en-gb.js":5930,"./en-ie":8081,"./en-ie.js":8081,"./en-il":1594,"./en-il.js":1594,"./en-in":3904,"./en-in.js":3904,"./en-nz":1507,"./en-nz.js":1507,"./en-sg":9409,"./en-sg.js":9409,"./eo":2177,"./eo.js":2177,"./es":4805,"./es-do":9155,"./es-do.js":9155,"./es-mx":9791,"./es-mx.js":9791,"./es-us":6098,"./es-us.js":6098,"./es.js":4805,"./et":6240,"./et.js":6240,"./eu":391,"./eu.js":391,"./fa":612,"./fa.js":612,"./fi":4220,"./fi.js":4220,"./fil":5570,"./fil.js":5570,"./fo":5466,"./fo.js":5466,"./fr":4461,"./fr-ca":6306,"./fr-ca.js":6306,"./fr-ch":7081,"./fr-ch.js":7081,"./fr.js":4461,"./fy":3484,"./fy.js":3484,"./ga":6957,"./ga.js":6957,"./gd":2978,"./gd.js":2978,"./gl":9866,"./gl.js":9866,"./gom-deva":5011,"./gom-deva.js":5011,"./gom-latn":4724,"./gom-latn.js":4724,"./gu":1601,"./gu.js":1601,"./he":9802,"./he.js":9802,"./hi":9358,"./hi.js":9358,"./hr":3907,"./hr.js":3907,"./hu":218,"./hu.js":218,"./hy-am":533,"./hy-am.js":533,"./id":2844,"./id.js":2844,"./is":7353,"./is.js":7353,"./it":6364,"./it-ch":774,"./it-ch.js":774,"./it.js":6364,"./ja":6008,"./ja.js":6008,"./jv":8221,"./jv.js":8221,"./ka":2417,"./ka.js":2417,"./kk":2071,"./kk.js":2071,"./km":6149,"./km.js":6149,"./kn":4572,"./kn.js":4572,"./ko":659,"./ko.js":659,"./ku":6285,"./ku-kmr":9398,"./ku-kmr.js":9398,"./ku.js":6285,"./ky":1609,"./ky.js":1609,"./lb":119,"./lb.js":119,"./lo":1748,"./lo.js":1748,"./lt":1973,"./lt.js":1973,"./lv":1347,"./lv.js":1347,"./me":3023,"./me.js":3023,"./mi":5747,"./mi.js":5747,"./mk":4341,"./mk.js":4341,"./ml":3840,"./ml.js":3840,"./mn":2058,"./mn.js":2058,"./mr":9182,"./mr.js":9182,"./ms":5197,"./ms-my":9136,"./ms-my.js":9136,"./ms.js":5197,"./mt":6408,"./mt.js":6408,"./my":1683,"./my.js":1683,"./nb":3141,"./nb.js":3141,"./ne":9344,"./ne.js":9344,"./nl":4703,"./nl-be":4641,"./nl-be.js":4641,"./nl.js":4703,"./nn":9873,"./nn.js":9873,"./oc-lnc":1217,"./oc-lnc.js":1217,"./pa-in":2231,"./pa-in.js":2231,"./pl":4457,"./pl.js":4457,"./pt":1089,"./pt-br":9146,"./pt-br.js":9146,"./pt.js":1089,"./ro":5950,"./ro.js":5950,"./ru":7292,"./ru.js":7292,"./sd":6774,"./sd.js":6774,"./se":7493,"./se.js":7493,"./si":3761,"./si.js":3761,"./sk":9711,"./sk.js":9711,"./sl":8558,"./sl.js":8558,"./sq":8633,"./sq.js":8633,"./sr":688,"./sr-cyrl":7903,"./sr-cyrl.js":7903,"./sr.js":688,"./ss":1991,"./ss.js":1991,"./sv":7020,"./sv.js":7020,"./sw":5891,"./sw.js":5891,"./ta":5714,"./ta.js":5714,"./te":206,"./te.js":206,"./tet":4768,"./tet.js":4768,"./tg":8276,"./tg.js":8276,"./th":7977,"./th.js":7977,"./tk":6928,"./tk.js":6928,"./tl-ph":8046,"./tl-ph.js":8046,"./tlh":1361,"./tlh.js":1361,"./tr":4367,"./tr.js":4367,"./tzl":627,"./tzl.js":627,"./tzm":2636,"./tzm-latn":8148,"./tzm-latn.js":8148,"./tzm.js":2636,"./ug-cn":8823,"./ug-cn.js":8823,"./uk":461,"./uk.js":461,"./ur":1366,"./ur.js":1366,"./uz":3454,"./uz-latn":8374,"./uz-latn.js":8374,"./uz.js":3454,"./vi":8572,"./vi.js":8572,"./x-pseudo":464,"./x-pseudo.js":464,"./yo":3709,"./yo.js":3709,"./zh-cn":5873,"./zh-cn.js":5873,"./zh-hk":7549,"./zh-hk.js":7549,"./zh-mo":2240,"./zh-mo.js":2240,"./zh-tw":405,"./zh-tw.js":405};function i(t){var e=a(t);return s(e)}function a(t){if(!s.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=a,t.exports=i,i.id=5358},5668:function(t,e,s){"use strict";var r=s(5130),i=s(6768);const a={style:{display:"flex","justify-content":"center"}};function n(t,e,s,r,n,o){const l=(0,i.g2)("app-content");return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.bF)(l)])}s(8992),s(8872);var o=s(4232),l=s.p+"img/star.9a4f94cd.svg";const u={class:"app-content"},c={class:"survey-nav"},h={class:"survey-items"},d=["onClick","title"],p={class:"institute-name"},v={class:"release-date"},y={class:"survey-playground-wrapper"},g={class:"playground"},m={key:0,style:{display:"flex","flex-direction":"column"}},f={style:{"font-size":"13px"}},k={key:1,class:"playground-footer-panel"},j={class:"coalition-results"},w={key:0,style:{"font-weight":"bolder"}},S={class:"coalition-results-content"},x={key:0,class:"optional"},b={class:"not-made-the-hurdle"},C=["onClick"],L={key:0,src:l};function R(t,e,s,r,a,n){const R=(0,i.g2)("select-party-value"),z=(0,i.g2)("coalition-diagram"),_=(0,i.g2)("timeline-diagram");return(0,i.uX)(),(0,i.CE)("div",u,[e[4]||(e[4]=(0,i.Lk)("div",{class:"subheading"},"Umfragen zur Bundestagswahl 2025 der letzten 14 Tage",-1)),(0,i.Lk)("div",{style:(0,o.Tr)({display:this.surveys.length?"none":"unset"})},e[1]||(e[1]=[(0,i.Lk)("h4",null,"Daten werden geladen...",-1),(0,i.Lk)("div",{class:"lds-dual-ring"},null,-1)]),4),(0,i.Lk)("div",c,[(0,i.Lk)("div",h,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.surveys,(t=>((0,i.uX)(),(0,i.CE)("div",{class:(0,o.C4)(["survey-item",{selected:t.id===n.selectedSurveyId}]),onClick:e=>n.selectSurvey(t.id),key:t.id,title:t?.institute.name+" - "+n.toDate(t.surveyPeriod.start)+" - "+n.toDate(t.surveyPeriod.end)+" | "+t.participants+" Teilnehmer"},[(0,i.Lk)("div",p,(0,o.v_)(t?.institute.name),1),(0,i.Lk)("div",v,(0,o.v_)(n.toDate(t?.release)),1)],10,d)))),128))])]),(0,i.Lk)("div",y,[(0,i.Lk)("div",g,[n.selectedSurveyId?((0,i.uX)(),(0,i.CE)("div",m,[e[2]||(e[2]=(0,i.Lk)("span",{style:{"font-weight":"bolder"}},"Stimmanteil der Parteien ",-1)),(0,i.Lk)("span",f,(0,o.v_)(n.selectedSurvey?.institute.name)+" "+(0,o.v_)(n.toDate(n.selectedSurvey?.release))+" "+(0,o.v_)(n.changed?"(geändert)":""),1)])):(0,i.Q3)("",!0),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.editingSurvey?.results,(t=>((0,i.uX)(),(0,i.Wv)(R,{partyResult:t,onOnLockChange:n.handleLockChange,onOnResultChange:n.handleResultChange,key:t},null,8,["partyResult","onOnLockChange","onOnResultChange"])))),128)),n.selectedSurveyId?((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("div",null,"Summe: "+(0,o.v_)(n.editingSurvey?.results?.reduce(((t,e)=>t+e.result),0))+"% ",1),(0,i.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>n.reset&&n.reset(...t)),class:"default-button"},"zurücksetzen")])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",j,[n.selectedSurveyId?((0,i.uX)(),(0,i.CE)("div",w," Mögliche Koalitionen basierend auf ihrer Auswahl ")):(0,i.Q3)("",!0),(0,i.Lk)("div",S,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.allCoalitions,(t=>((0,i.uX)(),(0,i.Wv)(z,{key:t.id,coalitionData:t},null,8,["coalitionData"])))),128))])])]),n.selectedSurveyId?((0,i.uX)(),(0,i.CE)("div",x,[e[3]||(e[3]=(0,i.Lk)("div",{class:"optional-title",title:"Über die sogenannte Grundmandatsklausel kann eine Partei auch dann gemäß ihrem Stimmenanteil ins Parlament einziehen, wenn sie die Fünfprozenthürde verpasst. Voraussetzung ist, dass sie in mindestens drei Wahlkreisen ein Direktmandat gewinnt."},[(0,i.Lk)("span",null,"Auswählen ob Partei über die Grundmandatsklausel einzieht"),(0,i.eW)(" ("),(0,i.Lk)("img",{class:"star",src:l}),(0,i.eW)(") ")],-1)),(0,i.Lk)("div",b,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.optionals,(t=>((0,i.uX)(),(0,i.CE)("button",{class:"hurdle-elem",key:t,onClick:e=>n.handleHurdleExceptionChange(t,!t.exception)},[t.exception?((0,i.uX)(),(0,i.CE)("img",L)):(0,i.Q3)("",!0),(0,i.Lk)("span",null,(0,o.v_)(t.party.shortcut),1)],8,C)))),128))])])):(0,i.Q3)("",!0),n.surveys.length?((0,i.uX)(),(0,i.Wv)(_,{key:1})):(0,i.Q3)("",!0)])}var z=s(1114),_=(s(4114),s(3215),s(4520),s(2577),s(3949),s(1454),s(657));const D=(0,_.nY)("AppStore",{state:()=>({_surveys:[],_selectedSurveyId:"",_editingSurvey:{},_coalitions:null}),actions:{setSurveys(t){this._surveys=t},setSelectedSurveyId(t){this._selectedSurveyId=t},setEditingSurvey(t){this._editingSurvey=t},setEditingSurveyResults(t){this._editingSurvey.results=t},setCoalitions(t){this._coalitions=t}},getters:{surveys:t=>t._surveys,selectedSurveyId:t=>t._selectedSurveyId,selectedSurvey:t=>t._surveys.find((e=>e.id===t._selectedSurveyId)),editingSurvey:t=>t._editingSurvey,coalitions:t=>t._coalitions}});var I=s(8847),E=s(9148),A=s.n(E),T=s.p+"img/checked.529582ff.svg",P=s.p+"img/unchecked.ad0c9919.svg",M=s.p+"img/lock_open.840c5880.svg",X=s.p+"img/lock_closed.25c9b781.svg";const G={class:"select-party-value"},O=["title"],F={class:"hurdle-indicator"},Y={key:0,src:T},B={key:1,src:P},H={key:2,src:l},K={class:"party-meta-name"},U={class:"party-meta-value"},V={class:"party-result-panel"},W={class:"range"},Q=["disabled","value"];function N(t,e,s,r,a,n){return(0,i.uX)(),(0,i.CE)("div",G,[(0,i.Lk)("div",{class:"party-meta",title:s.partyResult?.party.name+": "+s.partyResult?.result+"%"+(s.partyResult.result<5?" -> "+(s.partyResult.exception?t.text:"Nicht im Bundestag"):"")},[(0,i.Lk)("div",F,[!n.isSonstige(s.partyResult)&&s.partyResult.result>=5?((0,i.uX)(),(0,i.CE)("img",Y)):(0,i.Q3)("",!0),n.isSonstige(s.partyResult)||s.partyResult.result<5&&!s.partyResult.exception?((0,i.uX)(),(0,i.CE)("img",B)):(0,i.Q3)("",!0),!n.isSonstige(s.partyResult)&&s.partyResult.result<5&&s.partyResult.exception?((0,i.uX)(),(0,i.CE)("img",H)):(0,i.Q3)("",!0)]),(0,i.Lk)("span",K,(0,o.v_)(s.partyResult?.party.shortcut)+":",1),(0,i.Lk)("span",U,(0,o.v_)(s.partyResult?.result)+"%",1)],8,O),(0,i.Lk)("div",V,[(0,i.Lk)("div",W,[(0,i.Lk)("input",{type:"range",min:"0",max:"50",step:"0.5",disabled:s.partyResult.locked,class:(0,o.C4)([s.partyResult.party.shortcut.toLowerCase().replace(/ /g,"")]),value:s.partyResult.result,onInput:e[0]||(e[0]=(...t)=>n.updateResultState&&n.updateResultState(...t))},null,42,Q)]),(0,i.Lk)("button",{class:"lock",onClick:e[1]||(e[1]=t=>n.updateLockState(!s.partyResult.locked))},[(0,i.Lk)("img",{src:M,style:(0,o.Tr)({display:n.displayLockType(!s.partyResult.locked)})},null,4),(0,i.Lk)("img",{src:X,style:(0,o.Tr)({display:n.displayLockType(s.partyResult.locked)})},null,4)])])])}const q=5;function $(t){return A()(t).format("DD.MM.YY")}function Z(t){if("object"!==typeof t||!t)return t;if(t instanceof Date)return new Date(t);if(t instanceof Array)return t.map((t=>Z(t)));const e=Object.keys(t);return e.reduce(((e,s)=>{const r=t[s];return e[s]=Z(r),e}),{})}const J={spd:"rgb(217, 77, 65)",union:"rgb(97, 89, 82)",afd:"rgb(117, 192, 235)",fdp:"rgb(245, 210, 51)",linke:"rgb(181, 107, 184)",bsw:"rgb(191, 57, 100)","grüne":"rgb(132, 196, 98)",sonstige:"rgba(215,215,215,0.47)","freie wähler":"#e4a320"};function tt(t){return J[t.toLowerCase()]||"darkgrey"}const et="sonstige";var st={name:"select-party-value",components:{},emits:["onLockChange","onResultChange"],props:["partyResult"],created(){this.appStore=D()},watch:{partyResult(t,e){console.log(t,e)}},data:function(){return{appStore:null,text:"Zieht über die Grundmandatsklausel ein\n"}},methods:{displayLockType(t){return t?"unset":"none"},updateLockState(t){this.$emit("onLockChange",{prev:this.partyResult,locked:t})},updateResultState(t){this.$emit("onResultChange",{prev:this.partyResult,result:Number(t.target.value)}),t.target.value=this.partyResult.result},isSonstige(t){return t.party.shortcut.toLowerCase()===et}},computed:{}},rt=s(1241);const it=(0,rt.A)(st,[["render",N],["__scopeId","data-v-458bcf6c"]]);var at=it;const nt=["title"],ot={class:"coal-title"},lt={class:"party-diagram"};function ut(t,e,s,r,a,n){return(0,i.uX)(),(0,i.CE)("div",{class:"coalition-wrapper",title:n.titleString},[(0,i.Lk)("span",ot,(0,o.v_)(n.titleString),1),(0,i.Lk)("div",lt,[e[0]||(e[0]=(0,i.Lk)("div",{class:"half-indicator"},[(0,i.eW)("| "),(0,i.Lk)("span",{class:"half-indicator-title"},"50%")],-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.coalitionData.partys,(t=>((0,i.uX)(),(0,i.CE)("div",{class:"party-value-line",key:t.id,style:(0,o.Tr)({width:t.result+"%",backgroundColor:n.getColor(t.party.shortcut)})},null,4)))),128))])],8,nt)}var ct={name:"coalition-diagram",components:{},props:["coalitionData"],created(){this.appStore=D()},data:function(){return{appStore:null}},methods:{getColor(t){return tt(t)}},computed:{titleString(){return this.coalitionData.partys.map((t=>t.party.shortcut)).join(", ")+" - "+this.coalitionData.sum.toFixed(2)+"%"}}};const ht=(0,rt.A)(ct,[["render",ut],["__scopeId","data-v-70544d4d"]]);var dt=ht;const pt={class:"timeline-diagram-wrapper"};function vt(t,e,s,r,a,n){return(0,i.uX)(),(0,i.CE)("div",pt,[e[2]||(e[2]=(0,i.Lk)("div",{style:{"font-weight":"bolder"}},"Zeitlicher Verlauf der Umfrageergebnisse",-1)),(0,i.Lk)("canvas",{onMousemove:e[0]||(e[0]=(...t)=>n.onMouseMove&&n.onMouseMove(...t)),onTouchmove:e[1]||(e[1]=(...t)=>n.onMouseMove&&n.onMouseMove(...t)),ref:"_canvas",style:{"background-color":"#f6f6f6","border-radius":"4px"}},null,544)])}s(7642),s(8004),s(3853),s(5876),s(2475),s(5024),s(1698);class yt{constructor(t,e){(0,z.A)(this,"x",void 0),(0,z.A)(this,"y",void 0),this.x=t,this.y=e}clone(){return new yt(this.x,this.y)}add(t){return this.x+=t.x,this.y+=t.y,this}addX(t){return this.x+=Number(t),this}addY(t){return this.y+=t||0,this}static of(t){return new yt(t.x,t.y)}}class gt{constructor(t,e){(0,z.A)(this,"canvas",void 0),(0,z.A)(this,"ctx",void 0),(0,z.A)(this,"surveys",void 0),(0,z.A)(this,"partyGraphsMap",void 0),(0,z.A)(this,"highlightGraphId",null),(0,z.A)(this,"x",void 0),(0,z.A)(this,"y",void 0),(0,z.A)(this,"horizontalEnd",void 0),(0,z.A)(this,"marginTop",void 0),(0,z.A)(this,"surveyDates",void 0),(0,z.A)(this,"mousePosition",void 0),this.canvas=t,this.surveys=[...e],this.surveys.sort(((t,e)=>t.release.getTime()-e.release.getTime())),this.updateRequiredDataForDrawing()}updateRequiredDataForDrawing(){const t=Math.min(1280,.95*window.innerWidth);this.canvas.width=t,this.canvas.height=t/2,this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",this.ctx=this.canvas.getContext("2d"),this.updateBaseCoordinates(),this.collectXAxisDatesAndPixelPositions(this.x,this.y,this.marginTop),this.generatePartyGraphVectors(this.surveys),this.renderDiagram()}updateBaseCoordinates(){this.x=.05*this.canvas.width,this.y=this.canvas.height-this.x,this.horizontalEnd=.99*this.canvas.width,this.marginTop=.01*this.canvas.width}generatePartyGraphVectors(t){const e=this.collectResultsSortedByDate(t);this.generateVectorsForDrawing(e),this.partyGraphsMap=e}collectResultsSortedByDate(t){const e=new Map;return t.forEach((t=>{const s=$(t.release);t.results.forEach((t=>{if(t.party.shortcut.toLowerCase()===et)return;const r=t.party.shortcut.startsWith("CDU")?"Union":t.party.shortcut;let i=e.get(r);i||(i={partyId:r,vectors:[],color:tt(r)},e.set(r,i));const a=i.vectors.find((t=>t.release===s));a?a.results.push(t.result):i.vectors.push({results:[t.result],release:s})}))})),e}generateVectorsForDrawing(t){const e=this.canvas.height-(this.marginTop+this.x);for(let s of t.values())s.vectors.forEach((t=>{t.avgResult=t.results.reduce(((t,e)=>t+e),0)/t.results.length;const s=this.surveyDates.get(t.release);s&&(t.x=s,t.avgY=this.convertSurveyResultToPixel(e,t.avgResult),t.yList=t.results.map((t=>this.convertSurveyResultToPixel(e,t))))}))}convertSurveyResultToPixel(t,e){return this.canvas.height-this.x-t*(e/100*2)}renderDiagram(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawCoordinateSystem(),this.drawLegend(),this.drawGraphs(),this.drawMetaInfo()}drawMetaInfo(){if(this.highlightGraphId){const t=this.partyGraphsMap.get(this.highlightGraphId),e=t.vectors[t.vectors.length-1];this.drawText(this.highlightGraphId,new yt(.92*this.canvas.width,e.y+3),{color:tt(this.highlightGraphId),size:.014*this.canvas.width+"px"})}}drawCoordinateSystem(){const t={color:"black",width:1},e=new yt(this.x,this.y);this.drawLine(e,new yt(this.x,this.marginTop),t),this.drawLine(e,new yt(this.horizontalEnd,this.y),t),this.drawVerticalAxisPercentages(this.y,this.marginTop,this.x),this.drawHorizontalAxisPercentages(this.x,this.y)}drawVerticalAxisPercentages(t,e,s){const r=5,i=(this.canvas.height-(e+s))/r;for(let a=0;a<=r;a++){const e=t-i*a;this.drawText(10*a+"%",new yt(s/4,e+5),{size:Math.min(12,s/2.5)+"px"}),this.drawLine(new yt(s-4,e),new yt(s+4,e),{color:"black"})}}drawHorizontalAxisPercentages(t,e){for(let[s,r]of this.surveyDates)this.drawText(s,new yt(r-20,e+25)),this.drawLine(new yt(r,e-5),new yt(r,e+5),{color:"black"})}collectXAxisDatesAndPixelPositions(t,e,s){const r=this.surveys.reduce(((t,e)=>t.add($(e.release))),new Set),i=(this.canvas.width-(t+s))/r.size;let a=0;this.surveyDates=[...r].reduce(((e,s)=>{if(!e.has(s)){const r=t+i*a;e.set(s,r),a+=1}return e}),new Map)}detectGraphToHighlight(t){this.highlightGraphId=null;let e=!1;this.mousePosition=t;const s=this.partyGraphsMap.values();for(let r of s){for(let s=0;s<r.vectors.length-1;s++){const i=r.vectors[s],a=r.vectors[s+1],n=(a.avgY-i.avgY)/(a.x-i.x);if(!(t.x<i.x||t.x>a.x))if(0!==n){const s=n*t.x+(i.avgY-n*i.x);if(Math.abs(s-t.y)<3){this.highlightGraphId=r.partyId,e=!0;break}}else if(i.avgY-2<=t.y&&t.y<=i.avgY+2){this.highlightGraphId=r.partyId,e=!0;break}}if(e)break}this.renderDiagram()}drawLegend(){const t=new yt(.92*this.canvas.width,.04*this.canvas.height),e=.03*this.canvas.height,s=t.clone(),r=.0175*this.canvas.height,i=new yt(s.x+e,s.y);for(let a of this.partyGraphsMap.keys()){const t=tt(a);this.drawLine(s,i,{color:t,width:r/3}),this.drawText(a,i.clone().addX(r).addY(r/2.5),{size:r+"px",color:t}),s.y+=e,i.y+=e}}drawGraphs(){for(let e of this.partyGraphsMap.values())this.highlightGraphId!==e.partyId&&this.drawGraph(e.vectors,{color:e.color||"grey",width:1,radius:2,highlight:!1});const t=this.partyGraphsMap.get(this.highlightGraphId);t&&this.drawGraph(t.vectors,{color:t.color||"grey",width:2,radius:3,highlight:!0})}drawGraph(t,e){for(let s=0;s<t.length;s++){const r=t[s];if(s<t.length-1){const i=t[s+1];this.drawLine(new yt(r.x,r.avgY),new yt(i.x,i.avgY),e)}r.yList.forEach((t=>{this.drawDot(new yt(r.x,t),e)})),e.highlight&&this.drawText(r.avgResult.toFixed(1)+"%",new yt(r.x,r.avgY).addY(-.01*this.canvas.width),{size:.01*this.canvas.width+"px"})}}drawDot(t,e={color:"black",radius:2}){this.ctx.beginPath(),this.ctx.arc(t.x,t.y,e.radius,0,2*Math.PI),this.ctx.fillStyle=e.color||"black",this.ctx.fill()}drawText(t,e,s={color:"black",size:"11px"}){this.ctx.font=s.size+" arial",this.ctx.fillStyle=s.color||"black",this.ctx.fillText(t,e.x,e.y)}drawLine(t,e,s={color:"black",width:1}){this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.lineWidth=s.width||1,this.ctx.strokeStyle=s.color||"black",this.ctx.stroke()}drawRect(t,e,s={color:"black",rounded:5}){this.ctx.beginPath(),s.rounded?this.ctx.roundRect(t.x,t.y,e.x,e.y,[s.rounded,s.rounded]):this.ctx.rect(t.x,t.y,e.x,e.y),this.ctx.fillStyle=s.color||"black",this.ctx.fill()}}var mt={name:"timeline-diagram",components:{},created(){this.appStore=D(),window.addEventListener("resize",this.resizeHandler)},unmounted(){window.removeEventListener("resize",this.resizeHandler)},mounted(){this.canvas=this.$refs._canvas,this.drawer=new gt(this.canvas,this.surveys)},data:function(){return{appStore:null,canvas:null,drawer:null}},methods:{resizeHandler(){this.drawer.updateRequiredDataForDrawing()},isSonstige(t){return t.party.shortcut.toLowerCase()===et},onMouseMove(t){const e=this.translateMousePositionToCanvas(t);this.drawer.detectGraphToHighlight(e)},translateMousePositionToCanvas(t){const e=this.canvas.getBoundingClientRect(),s=new yt(this.canvas.width/e.width,this.canvas.height/e.height);return new yt((t.clientX-e.left)*s.x,(t.clientY-e.top)*s.y)},filterSurveys(t){return t.reduce(((t,e)=>(t.find((t=>t.release.getTime()===e.release.getTime()))||t.push(e),t)),[])}},computed:{surveys(){return this.appStore.surveys}}};const ft=(0,rt.A)(mt,[["render",vt],["__scopeId","data-v-dea08dfa"]]);var kt=ft;class jt{constructor(){(0,z.A)(this,"_map",void 0),this._map=new Map}addSafe(t){let e=this._map.get(t.partys.length);e||(e=[],this._map.set(t.partys.length,e)),e.push(t)}keys(){return this._map.keys()}getAllCoalitions(){let t=[];const e=[...this._map.keys()];e.sort();for(let s of e){const e=this._map.get(s);t=[...t,...e]}return t.sort(this.sortByPartnersAndSum),t}sortByPartnersAndSum(t,e){const s=t.partys.length-e.partys.length;return 0===s?e.sum-t.sum:s}}class wt{constructor(t,e,s){(0,z.A)(this,"partys",void 0),(0,z.A)(this,"sum",void 0),(0,z.A)(this,"id",void 0),this.partys=t,this.id=s,this.sum=e}}var St={name:"App-Content",components:{TimelineDiagram:kt,CoalitionDiagram:dt,SelectPartyValue:at},created(){this.appStore=D(),this.updatePolls()},data:function(){return{appStore:null}},methods:{toDate:function(t){return $(t)},async updatePolls(){const t=new I.zh;await t.update();const e=A()().subtract(14,"days").toDate(),s=t.select([I.XK.include([I.pe.Surveys]),I.XK.Survey.Release.isGreater(e),I.XK.Survey.Parliament.Shortcut.is(["Bundestag"]),I.XK.Survey.Sort.byParticipants(I.pH.Asc),I.XK.Survey.Sort.allResults(I.pH.Desc)]);this.sortSurveys(s.surveys),this.appStore.setSurveys(s.surveys),this.selectedSurveyId||this.selectLatestSurvey(s.surveys.map((t=>t.id)))},reset(){this.selectSurvey(this.selectedSurveyId,!0)},selectLatestSurvey(t){this.selectSurvey(t[0],!0)},sortResultsBy(t,e){let s=null;if("result"===e&&(s=(t,e)=>Number(e.result)-Number(t.result)),"shortcut"===e&&(s=(t,e)=>t.party.shortcut.localeCompare(e.party.shortcut)),!s)return-1;t.sort(((t,e)=>t.party.shortcut.toLowerCase()===et?1:e.party.shortcut.toLowerCase()===et?-1:s(t,e)))},sortSurveys(t){t.sort(((t,e)=>e.release.getTime()-t.release.getTime())),t.forEach((t=>{this.sortResultsBy(t.results,"result")}))},selectSurvey(t,e=!1){if(t===this.selectedSurveyId&&!e)return;this.appStore.setSelectedSurveyId(t);const s=this.appStore.selectedSurvey,r=Z(s);this.patchCDUShortcut(r),r.results.forEach((t=>{t.locked=!1,t.exception=!1})),this.appStore.setEditingSurvey(r),this.generateCoalitions()},generateCoalitions(){const t=this.prepareResults(this.editingSurvey?.results),e=new jt;this.traverseCoalitions(null,t,e),this.appStore.setCoalitions(e)},prepareResults(t){const e=t=>t.party.shortcut.toLowerCase()!==et&&(t.result>=5||t.exception),s=Z(t).filter(e),r=s.reduce(((t,e)=>t+e.result),0);return s.map((t=>{const e=t.result/r*100;return{...t,result:e}})).sort(((t,e)=>e.result-t.result))},traverseCoalitions(t,e,s){this.counts+=1,t||(t=[]);const r=[...t];for(let i of e){r.push(i);const a=[...t,i];a.sort(((t,e)=>e.result-t.result));const n=a.reduce(((t,e)=>t+e.result),0);if(n>50){const t=new wt(a,n,"id");s.addSafe(t);continue}const o=e.filter((t=>!r.includes(t)));o.length>0&&this.traverseCoalitions([...a],o,s)}},patchCDUShortcut(t){const e=t.results.find((t=>t.party.shortcut.toLowerCase().startsWith("cdu")));e.party.shortcut="Union"},handleLockChange(t){t.prev.locked=t.locked},handleResultChange(t){this.updateUnlockedResults(t),this.generateCoalitions()},handleHurdleExceptionChange(t,e){t.exception=e,this.generateCoalitions()},updateUnlockedResults(t){const e=t.result-t.prev.result;if(0===e)return;const s=this.appStore.editingSurvey.results.filter((t=>!t.locked)).filter((e=>e!==t.prev));if(0===s.length)return;let r=Math.abs(e);const i=this.isPositive(e)?1:-1,a=this.isPositive(i)?function(t){return e=>e.result>=t}:function(t){return e=>e.result<50-t},n=.5*i;while(r>0){const e=r<1?i*r:n,o=a(Math.abs(e));this.executeSingleStepChange(e,t.prev,s,o),r-=1}const o=[...this.appStore.editingSurvey.results.map((e=>e!==t?e:Z(t.prev)))];this.appStore.setEditingSurveyResults(o)},executeSingleStepChange(t,e,s,r){const i=s.filter(r);0!==i.length&&(e.result+=t,this.changeValueOfRandomResult(i,-t))},changeValueOfRandomResult(t,e){const s=Math.trunc(Math.random()*t.length);t[s].result=Number(t[s].result)+e},isPositive(t){return t>0}},computed:{surveys(){return this.appStore.surveys},selectedSurvey(){return this.appStore.selectedSurvey},coalitions(){return this.appStore.coalitions},changed(){const t=this.selectedSurvey;return!this.editingSurvey.results.every((e=>t.results.find((t=>t.party.id===e.party.id&&t.result===e.result))))},allCoalitions(){const t=this.appStore.coalitions;return t?t.getAllCoalitions():[]},editingSurvey(){return this.appStore.editingSurvey},selectedSurveyId(){return this.appStore.selectedSurveyId},optionals(){return this.appStore.editingSurvey.results?this.appStore.editingSurvey.results.filter((t=>"sonstige"!==t.party.shortcut.toLowerCase())).filter((t=>t.result<q)):[]}}};const xt=(0,rt.A)(St,[["render",R],["__scopeId","data-v-2dc9495e"]]);var bt=xt,Ct={name:"App",components:{AppContent:bt}};const Lt=(0,rt.A)(Ct,[["render",n]]);var Rt=Lt;class zt{}const _t=(0,r.Ef)(Rt);_t.config.globalProperties.$appService=new zt,_t.use((0,_.Ey)()),_t.mount("#app")}},e={};function s(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.m=t,function(){var t=[];s.O=function(e,r,i,a){if(!r){var n=1/0;for(c=0;c<t.length;c++){r=t[c][0],i=t[c][1],a=t[c][2];for(var o=!0,l=0;l<r.length;l++)(!1&a||n>=a)&&Object.keys(s.O).every((function(t){return s.O[t](r[l])}))?r.splice(l--,1):(o=!1,a<n&&(n=a));if(o){t.splice(c--,1);var u=i();void 0!==u&&(e=u)}}return e}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[r,i,a]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){s.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){s.p="/german-election-2025-coalitions/"}(),function(){var t={524:0};s.O.j=function(e){return 0===t[e]};var e=function(e,r){var i,a,n=r[0],o=r[1],l=r[2],u=0;if(n.some((function(e){return 0!==t[e]}))){for(i in o)s.o(o,i)&&(s.m[i]=o[i]);if(l)var c=l(s)}for(e&&e(r);u<n.length;u++)a=n[u],s.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return s.O(c)},r=self["webpackChunkcoalition_rechner"]=self["webpackChunkcoalition_rechner"]||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))}();var r=s.O(void 0,[504],(function(){return s(5668)}));r=s.O(r)})();
//# sourceMappingURL=app.eb94b1e3.js.map